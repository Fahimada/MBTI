<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>پرسش‌نامه شخصیت‌شناسی MBTI</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #f9f9f9;
      color: #333;
      line-height: 2;
      padding: 2rem;
      max-width: 900px;
      margin: auto;
    }
    h1 {
      text-align: center;
    }
    form {
      display: flex;
      flex-direction: column;
    }
    fieldset {
      margin-bottom: 2rem;
      border: none;
      border-bottom: 1px solid #ccc;
      padding-bottom: 1rem;
    }
    legend {
      font-weight: bold;
    }
    .options {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      margin-top: 0.5rem;
    }
    label {
      display: flex;
      align-items: center;
      gap: 0.3rem;
    }
    .submit-btn {
      align-self: center;
      padding: 0.8rem 2rem;
      background-color: #6c4de6;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 1rem;
      cursor: pointer;
    }
    .submit-btn:hover {
      background-color: #5a3dd1;
    }
    .question-title {
      font-weight: bold;
      margin-bottom: 0.5rem;
    }
  </style>
</head>
<body>
  <h1>پرسش‌نامه شخصیت‌شناسی MBTI</h1>
  <form id="mbtiForm">

    <!-- در اینجا به‌صورت اتوماتیک 60 سوال جاگذاری می‌شود -->
    <div id="questions"></div>

    <button class="submit-btn" type="submit">مشاهده نتیجه</button>
  </form>

  <script src="mbti_links.js"></script>
  <script>
    const questions = [
      "شما مرتب دوستان جدیدی پیدا می‌کنید.",
      "معمولاً بدون برنامه‌ریزی قبلی عمل می‌کنید.",
      "وقتی در جمع هستید، انرژی می‌گیرید.",
      "ترجیح می‌دهید تنها کار کنید تا در گروه.",
      "بیشتر بر اساس منطق تصمیم می‌گیرید تا احساس.",
      "نسبت به جزئیات حساس هستید.",
      "در موقعیت‌های اجتماعی، آغازگر گفت‌وگو هستید.",
      "از قبل برای تعطیلات برنامه‌ریزی می‌کنید.",
      "در بحث‌ها ترجیح می‌دهید سکوت کنید تا مقابله.",
      "به‌راحتی با احساسات دیگران همدلی می‌کنید.",
      // ... ادامه تا سوال 60
    ];

    const options = [
      "کاملاً مخالفم", "مخالفم", "کمی مخالفم", "خنثی", "کمی موافقم", "موافقم", "کاملاً موافقم"
    ];

    const container = document.getElementById("questions");

    questions.forEach((text, index) => {
      const fieldset = document.createElement("fieldset");

      const legend = document.createElement("legend");
      legend.className = "question-title";
      legend.textContent = `${index + 1}. ${text}`;
      fieldset.appendChild(legend);

      const optionsContainer = document.createElement("div");
      optionsContainer.className = "options";

      options.forEach((label, i) => {
        const optionLabel = document.createElement("label");

        const input = document.createElement("input");
        input.type = "radio";
        input.name = `q${index}`;
        input.value = i - 3; // مقداردهی: -3 تا +3
        input.required = true;

        optionLabel.appendChild(input);
        optionLabel.append(label);
        optionsContainer.appendChild(optionLabel);
      });

      fieldset.appendChild(optionsContainer);
      container.appendChild(fieldset);
    });

    document.getElementById("mbtiForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const data = new FormData(e.target);
      const scores = {
        E: 0, I: 0,
        S: 0, N: 0,
        T: 0, F: 0,
        J: 0, P: 0
      };
      
      // امتیازدهی نمونه: فرضی، قابل تغییر
      data.forEach((val, key) => {
        const index = parseInt(key.slice(1));
        const v = parseInt(val);
        if ([0, 2, 4, 6].includes(index % 8)) scores.E += v; else scores.I += v;
        if ([1, 3, 5, 7].includes(index % 8)) scores.S += v; else scores.N += v;
        if ([0, 1, 6, 7].includes(index % 8)) scores.T += v; else scores.F += v;
        if ([2, 3, 4, 5].includes(index % 8)) scores.J += v; else scores.P += v;
      });

      const result =
        (scores.E >= scores.I ? "E" : "I") +
        (scores.S >= scores.N ? "S" : "N") +
        (scores.T >= scores.F ? "T" : "F") +
        (scores.J >= scores.P ? "J" : "P");

      window.location.href = getMbtiLink(result);
    });
  </script>
</body>
</html>
